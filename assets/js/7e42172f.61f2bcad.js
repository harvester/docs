"use strict";(self.webpackChunkharvester_docs=self.webpackChunkharvester_docs||[]).push([[87141],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=d(n),p=r,h=c["".concat(l,".").concat(p)]||c[p]||m[p]||s;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,o=new Array(s);o[0]=p;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[c]="string"==typeof e?e:r,o[1]=i;for(var d=2;d<s;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},64233:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>l});n(67294);var a=n(3905);const r={sidebar_position:7,sidebar_label:"Management Address",title:"Management Address",keywords:["VIP"],description:"The Harvester provides a virtual IP as the management address."},s=void 0,o={unversionedId:"install/management-address",id:"version-v1.4/install/management-address",title:"Management Address",description:"The Harvester provides a virtual IP as the management address.",source:"@site/versioned_docs/version-v1.4/install/management-address.md",sourceDirName:"install",slug:"/install/management-address",permalink:"/v1.4/install/management-address",draft:!1,editUrl:"https://github.com/harvester/docs/edit/main/versioned_docs/version-v1.4/install/management-address.md",tags:[],version:"v1.4",lastUpdatedAt:1732780556,formattedLastUpdatedAt:"Nov 28, 2024",sidebarPosition:7,frontMatter:{sidebar_position:7,sidebar_label:"Management Address",title:"Management Address",keywords:["VIP"],description:"The Harvester provides a virtual IP as the management address."},sidebar:"api",previous:{title:"Update Harvester Configuration",permalink:"/v1.4/install/update-harvester-configuration"},next:{title:"Install Harvester Binaries Only",permalink:"/v1.4/install/install-binaries-mode"}},i={},l=[{value:"Requirements",id:"requirements",level:2},{value:"How to get the VIP MAC address",id:"how-to-get-the-vip-mac-address",level:2},{value:"Identifying the Node the VIP Is Assigned To",id:"identifying-the-node-the-vip-is-assigned-to",level:2},{value:"Usages",id:"usages",level:2}],d={toc:l},u="wrapper";function c({components:e,...t}){return(0,a.kt)(u,{...d,...t,components:e,mdxType:"MDXLayout"},(0,a.kt)("head",null,(0,a.kt)("link",{rel:"canonical",href:"https://docs.harvesterhci.io/v1.4/install/management-address"})),(0,a.kt)("p",null,"Harvester provides a fixed virtual IP (VIP) as the management address, VIP must be different from any Node IP.  You can find the management address on the console dashboard after the installation."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"If you selected the IP address to be configured via DHCP, you will need to configure static MAC-to-IP address mapping on your DHCP server in order to have a persistent Virtual IP")),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(15336).Z,width:"1530",height:"1150"})),(0,a.kt)("h2",{id:"requirements"},"Requirements"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The VIP and the node management interfaces must belong to the same subnet."),(0,a.kt)("li",{parentName:"ul"},"All Harvester node management interfaces must be on the same layer-2 network segment.")),(0,a.kt)("p",null,"Both are required because the VIP relies on the Address Resolution Protocol (ARP), which is a layer-2 protocol."),(0,a.kt)("p",null,"The VIP can be assigned to any Harvester node management interface and can change at any time (not only when node failure occurs). When the VIP changes hosts, ",(0,a.kt)("em",{parentName:"p"},"gratuitous ARPs")," are sent so that other hosts on the network know where to direct traffic intended for the Harvester cluster's management IP address (the VIP)."),(0,a.kt)("admonition",{type:"warning"},(0,a.kt)("p",{parentName:"admonition"},'If you plan to host a Harvester cluster in a bare metal data center, the service provider will likely designate a "floating" or "reserved" IP address as the VIP that you can assign to one of your servers. Updating this assignment causes traffic to instantly start flowing to the new node it is assigned to. In these situations, Harvester is unable to update the floating/reserved IP assignment in your provider\'s systems when the VIP changes hosts.'),(0,a.kt)("p",{parentName:"admonition"},"Furthermore, the VIP's \"gratuitous ARPs\" may also be ineffective depending on your provider's networking setup between your Harvester nodes (for example, if your Harvester hosts are not on the same layer-2 network). You must update the floating/reserved IP assignment manually when the VIP changes hosts to ensure that the cluster functions properly. For more information, see ",(0,a.kt)("a",{parentName:"p",href:"#finding-which-node-the-vip-is-on"},"Finding which node the VIP is on"),".")),(0,a.kt)("h2",{id:"how-to-get-the-vip-mac-address"},"How to get the VIP MAC address"),(0,a.kt)("p",null,"To get the VIP MAC address, you can run the following command on the management node:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get svc -n kube-system ingress-expose -ojsonpath='{.metadata.annotations}'\n")),(0,a.kt)("p",null,"Example of output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{"kube-vip.io/hwaddr":"02:00:00:09:7f:3f","kube-vip.io/requestedIP":"10.84.102.31"}\n')),(0,a.kt)("h2",{id:"identifying-the-node-the-vip-is-assigned-to"},"Identifying the Node the VIP Is Assigned To"),(0,a.kt)("p",null,"You can use kubectl (either on your local machine with the Harvester kubeconfig file, or when using SSH to connect to any Harvester management node as a root user)."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"kubectl -n kube-system get svc ingress-expose -o jsonpath='{.metadata.annotations.kube-vip\\.io/vipHost}'\n")),(0,a.kt)("p",null,"Example output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"harvester-xzj76\n")),(0,a.kt)("p",null,"Alternatively, you can use SSH to connect to each Harvester management node and then run the command ",(0,a.kt)("inlineCode",{parentName:"p"},"ip address show mgmt-br"),"."),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"harvester-xzj76:~ # ip address show mgmt-br\n4: mgmt-br: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000\n    link/ether 8c:dc:d4:b5:f0:fd brd ff:ff:ff:ff:ff:ff\n    inet 172.19.108.45/21 brd 172.19.111.255 scope global mgmt-br\n       valid_lft forever preferred_lft forever\n    inet 172.19.108.34/32 scope global mgmt-br\n       valid_lft forever preferred_lft forever\n")),(0,a.kt)("p",null,"When the output includes both the VIP and the node address, the VIP is assigned to the node that you are connected to."),(0,a.kt)("h2",{id:"usages"},"Usages"),(0,a.kt)("p",null,"The management address:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Allows the access to the Harvester API/UI via ",(0,a.kt)("inlineCode",{parentName:"li"},"HTTPS")," protocol."),(0,a.kt)("li",{parentName:"ul"},"Allows other nodes to join the cluster.\n",(0,a.kt)("img",{src:n(98350).Z,width:"1207",height:"339"}))))}c.isMDXComponent=!0},98350:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/configure-management-address-43ff76d24277f42606a4ad31cea2464b.png"},15336:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/iso-installed-8acd6980132f3402a086b63624ec9abf.png"}}]);